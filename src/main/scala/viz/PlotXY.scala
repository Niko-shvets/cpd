package viz

package utils


import java.io.FileWriter
import java.util.Random

import breeze.plot._
import breeze.linalg._

import scala.collection.mutable.ArrayBuffer

class PlotXY(xlabel: String, ylabel: String) {

  val f = Figure()
  val p = f.subplot(0)
  p.xlabel = xlabel
  p.ylabel = ylabel
  p.legend = false
  p.setYAxisDecimalTickUnits()

  p.setXAxisDecimalTickUnits()
  // p.logScaleX = true

  val lines = ArrayBuffer[(String, DenseVector[Double], DenseVector[Double])]()


  var lc = 0

  def addline(x: DenseVector[Double], y: DenseVector[Double], name: String) {
    p += plot(x, y, name = name, shapes = true)
    lc += 1
    // if (lc > 1) p.legend = true

    lines += Triple(name, x, y)
  }

  def addline(y: DenseVector[Double], name: String) {
    val x:  DenseVector[Double] = DenseVector(Range(0, y.length).map(_.toDouble).toArray)
    p += plot(x, y, name = name, shapes = true)
    lines += Triple(name, x, y)
  }

  def addline(y: Array[Double], name: String) {
    addline(DenseVector[Double](y), name)
  }

  def addline(x: Array[Double], y: Array[Double], name: String) {
    addline(DenseVector[Double](x), DenseVector[Double](y), name)
  }

  def addline(y: Array[(Int, Double)], name: String) {
    addline(DenseVector(y.map(_._1.toDouble)), DenseVector[Double](y.map(_._2)), name)
  }

  def addNoizedLine(x1: Double, x2: Double, y1: Double, y2: Double, k: Int): Unit = {
    val r = new Random()

    val xarr = (0 until k).map(i => x1 + i * (x2 - x1) / k).toArray

    val yarr = (0 until k).map(i => y1 + i * (y2 - y1) / k + r.nextGaussian() / 10).toArray

    p += plot(xarr, yarr, name = "", shapes = true, lines=false)

  }


  val buffer: ArrayBuffer[(Double, Double)] = ArrayBuffer()

  def addDot(x: Double, y: Double): Unit = {
    buffer += Pair(x, y)
  }

  def print(path: String) {

    addline(buffer.result().toArray.map(_._1), buffer.result().toArray.map(_._2), "")

    f.saveas(path)
    val fw = new FileWriter(path + ".txt")

    lines.result().foreach({case(s, x, y) =>
      fw.write(s + "\n")
      x.toArray.zip(y.toArray).foreach({case(i,j) => fw.write(i + "," + j + "\n")})
    })

    fw.close()

  }
}

object PlotApp extends App {
  val pl = new PlotXY("x", "y")


  val data = DenseVector[Double](0.07138250259318014,0.07173045811689165,0.07094199340509137,0.07093969525941987,0.07095907585517337,0.07150256802960056,0.07170454393403938,0.07305346293012531,0.07281985257615738,0.07197163364799236,0.07161442217820599,0.07217870892426956,0.07235877212905775,0.07246834429745684,0.0722502958315916,0.07233765175500492,0.07335367133385637,0.07290303355929657,0.07312995709533292,0.07402864250708843,0.07292430894134819,0.07262429594378131,0.0736683096414419,0.07349239900627247,0.0733541749694815,0.07280524466751573,0.07322438447669573,0.07262776271220567,0.07224340066406518,0.07172918782723664,0.0721225231701697,0.07302184720649045,0.07346517443285261,0.07319666054581467,0.07362393962612747,0.07346937164416817,0.0736254581372737,0.07407959829326222,0.07440411818162487,0.07380763861875492,0.07444058047016214,0.07475742945221238,0.0745765409359552,0.07462473962440744,0.07434691041125183,0.07526336153770627,0.07663001933611717,0.07987452198670575,0.08005653608395102,0.08065177392590918,0.08100168131724242,0.08159459917356797,0.08198027027131605,0.08433980873953899,0.08463678075346566,0.08491451244504508,0.0856494060438454,0.08574952093423946,0.08584787992174478,0.08669390885456148,0.08607427185677362,0.08631714732235365,0.08677462011232362,0.08684578829918704,0.08708904462465994,0.08716961036682788,0.0872922648234304,0.08859470303400932,0.08866175769909582,0.08899258628460485,0.08871230819995098,0.08908999832122969,0.08860689969346794,0.08872118073015428,0.08885214592427604,0.08787519773355233,0.08876805690656737,0.08987613569063896,0.09134056514205281,0.09193719007611809,0.09182924783403729,0.0919841830007105,0.09263580365314517,0.09269036958071367,0.09303565570157793,0.09357741182059227,0.09441460511710101,0.09476109025983023,0.09483920458904768,0.09453135407715696,0.09492103921349711,0.09516490954408449,0.09494805948792624,0.09461062695101627,0.09519443399237985,0.09526607286223177,0.09513067482298262,0.09575688402333378,0.09499222330846938,0.0946976479249937,0.09475200777905064,0.09505520992898994,0.09447902186091525,0.0953426643146803,0.09604501260545324,0.09786135507539793,0.09856346604419183,0.10017791975295498,0.09975393416911071,0.09991215067954724,0.10025252991074547,0.10070430503686803,0.10118381087125976,0.10028821933212484,0.10079228652014376,0.10006944135783738,0.10053148283323017,0.101148832533752,0.1009002784686031,0.10101131140186019,0.10092636225102025,0.10138469651273116,0.10036982397302881,0.1012631035527416,0.1010422000464097,0.10010547535183736,0.1006432856434943,0.10171382924871808,0.10139423132801488,0.10201139156977326,0.10275528938265195,0.10268694392237261,0.10385724722345462,0.10409730193612513,0.10420975894737487,0.10344736071142677,0.10314615658290409,0.10296611411663663,0.1029868875955354,0.10262979501813314,0.10340024247244428,0.10419726786466268,0.10326190193347932,0.10317451416637409,0.10238175568592016,0.10203295781071908,0.1017740784102483,0.1032446158600819,0.10231846456919669,0.10233842069486146,0.10237418221157298,0.10142447314916163,0.10072044398899598,0.10050248463272304,0.09934330740374321,0.09893629802835198,0.09932147191367932,0.09773510761467338,0.09762788839029016,0.09759050544947766,0.09841442927430466,0.09824835262181798,0.0996120633361365,0.09802074738543626,0.09854262754100043,0.09800458312497361,0.09837535911980842,0.09849139472330343,0.10111359939600115,0.1008852460258431,0.10101625979537207,0.10288158424132723,0.1031604567665344,0.10234869135985343,0.1024790191225298,0.10168318552688056,0.10187650633478662,0.10237598416423983,0.10442297468131974,0.10489380428863171,0.10531519587268778,0.10564722593950956,0.10577222053729252,0.1073520969921794,0.1078278603891317,0.1075436550237225,0.10767812889243619,0.10899767661711432,0.11000979880272128,0.11080942046511785,0.11173528594281783,0.11303533544370789,0.11340422426547865,0.11458739324582423,0.11418877682745751,0.11444314516819087,0.1144632552361609,0.11478754390017074,0.1152923091725154,0.11464419611376653,0.11555898788436292,0.11469795034692307,0.11399715130606894,0.116123403879876,0.11633689056040497,0.11765491015346426,0.11752963047871492,0.11834633578522295,0.11844417594248088,0.11903642475859837,0.11847864832222268,0.11835717968678683,0.11930496020403569,0.11938557908013617,0.12057334718176102,0.11980776421420018,0.11953009415929435,0.11931626000116782,0.11875766056227344,0.11845388799810122,0.11940511831845813,0.11887516987292253,0.11798085816924808,0.11833090768188385,0.11773508798962744,0.11838206122408865,0.11869010651994065,0.11816675692562421,0.11934291928893023,0.12590038120354352,0.12905921152854133,0.1299335863266526,0.13138657137787446,0.1338219741454655,0.13570098840721456,0.1365059918887363,0.13767742137987626,0.13881775831699977,0.14051793470732676,0.14105834863204403,0.14257633313914114,0.142415592352978,0.14492436944948947,0.14790453027061734,0.14910968669684535,0.15382618227734188,0.15627899837849699,0.1573100383584372,0.15866827081081877,0.16012920782418977,0.16143294717491924,0.16201792026180803,0.1631708637932599,0.1633077691766336,0.16517363118923228,0.1650915568315346,0.1662617021841907,0.16432453850877174,0.16336403906487862,0.16361162573071383,0.16459732727624038,0.16350841550958745,0.16291951111548797,0.16181355429677594,0.16293840260491385,0.16325152604354815,0.16269613385046755,0.16330802351290513,0.16497875039686566,0.1645739263243731,0.16596336291504327,0.1648325106591582,0.16691835928957327,0.1672683973096364,0.16745137626621415,0.16869721145260677,0.17019467445807906,0.16970083987138532,0.17318416871401926,0.17145031579977182,0.17620592641295896,0.17668306408359513,0.1760095497352338,0.17724134743139905,0.1787726463795703,0.1803721361430591,0.1810895909722739,0.18153637539997053,0.1853389534017755,0.18520647296345236,0.18536141440579978,0.18682915639387485,0.19128208759475307,0.1929417661139565,0.1919914565024356,0.19154562827373123,0.19274357185418536,0.1932818046407275,0.19107437072727648,0.19064170830046595,0.1905326109817312,0.1903886406758118,0.1910583458281661,0.1936135601558739,0.19246692563167506,0.19226094955026146,0.19273748780915573,0.19341415402927672,0.19496220146519452,0.19450715246208822,0.19236112930512503,0.19368528823750963,0.1959535009650481,0.19698362400410804,0.19841401704625378,0.19720109629500518,0.2017734328886724,0.19661732925427716,0.20043360109459898,0.19861594231894683,0.2018810399322201,0.2008874088827198,0.19838124859442036,0.19994438520446406,0.20083817168570567,0.20109497677414065,0.2028477879991903,0.20376915620714292,0.20285281423045384,0.2136754007890646,0.21445274100400274,0.21747063037261977,0.2196705310830223,0.2235156618699295,0.22555051105661125,0.22635656429452436,0.2281254980630894,0.23151239367533888,0.23468907278970813,0.2361592881034233,0.2397381389095338,0.24178897018184364,0.24345069109601242,0.24621022920029292,0.24761088235581194,0.25209346602644683,0.25687475034202617,0.2587593683048484,0.2602216799797417,0.2612894658776701,0.264016376145232,0.2663351258487907,0.2672947956425183,0.2692911333817388,0.2707293630172855,0.2735445669081522,0.2748806665345843,0.2762092050182878,0.27405874596212637,0.277139439125272,0.2778606900297266,0.27736426871193387,0.2783882403800463,0.2799345727141732,0.2802412865075326,0.280694697149041,0.2813118763617489,0.280656515252104,0.2809839150022928,0.28156491572565734,0.28264769907707477,0.2838163652607473,0.28392272077209,0.28520967601798053,0.2844883031968263,0.2856404866627689,0.29016748830332895,0.2872156993009273,0.28789034351803255,0.28663292445681604,0.2843258885238774,0.2854761641662187,0.28566832668140923,0.284518673894223,0.2828829959709588,0.28356832985441666,0.28352798547901,0.28473542717992484,0.2838163215618069,0.28212405294895604,0.28250363809345663,0.28284822046306984,0.28472003861220396,0.2841035235547764,0.28386718927474475,0.28373183507868044,0.2831039221118409,0.28427100053311677,0.2826534928035126,0.2836287755113928,0.28141392477404176,0.2810439715982091,0.2825751727635121,0.2832197607826329,0.28313964847138035,0.28395602986109036,0.2850585733447778,0.2851861976209614,0.2859646433611768,0.2862479143163396,0.2832938585835578,0.28630829389474755,0.28464276517110276,0.2845566273434901,0.2839174104273928,0.2838011336944063,0.28432260074471216,0.27859718308192516,0.2784727511710883,0.27573520079266256,0.2786580570022772,0.2768384728990152,0.2729975502536631,0.2725277630826595,0.2727417821968231,0.27243686010823476,0.2740389894171834,0.27274530346778636,0.2729537385091429,0.2703186990382526,0.2693186734754323,0.26714980157652846,0.2669658565014027,0.2663396577404332,0.2653178319286248,0.26370427532569773,0.2615055445802993,0.26049332955947724,0.26056736768142913,0.2586106288964892,0.2554815661859354,0.2535286756541581,0.2532582905051909,0.2543371155345159,0.2508982732644463,0.24987685942141796,0.2505783398810689,0.24537095109652135,0.2443079286497228,0.24185043557817934,0.24091568803151758,0.24045023799982967,0.23859130580309582,0.2423036967965611,0.23947286193871262,0.23920278219605512,0.23697325022408458,0.23659788537045529,0.2314855521350745,0.23245142401511515,0.22971314627112777,0.22779431609426917,0.22749617078478038,0.2274322647119274,0.225457468662756,0.22621586865648413,0.22419089287247645,0.22130352669242712,0.2210759648184458,0.22169503869501778,0.22043144548621124,0.22250810523547065,0.22050954497494332,0.21970810354435288,0.21821205798567972,0.21750010900597236,0.21571846026103353,0.21030869267152213,0.20690095553922702,0.20275715098117802,0.20172633134320014,0.20399683212131187,0.2041371311677945,0.20391088099184299,0.201299608516684,0.20224104282887154,0.20197302452507732,0.20123462708966144,0.2005435536452199,0.19846309338118476,0.1970822250834281,0.19422077101801777,0.1894739927132903,0.18814281675408406,0.18717075839259353,0.18657655276636764,0.18480823786724965,0.18460177345726436,0.1856084668839199,0.18401052576663196,0.1817841713879148,0.1804515186177725,0.18117209969013406,0.1813988816163687,0.18216295136341995,0.18239770275174472,0.18424111111030295,0.18418163984929073,0.1831771768040354,0.18569151282777271,0.18376100867191444,0.1853977586570187,0.18399854369115676,0.18241844126173784,0.18067547357562252,0.1812595199416798,0.17802568089988255,0.1762748363182552,0.17374605735718976,0.17373836835052842,0.17293058669150216,0.17153415726698382,0.17026297031727416,0.16794148789376442,0.1678432320805858,0.16680653732062897,0.1668443953366645,0.16579611206800562,0.16504910869736522,0.16228499278417857,0.16167123064482783,0.16194155021519446,0.1622499880843387,0.16124180411247108,0.16158052164199804,0.1599718195962559,0.158444778631825,0.15793862556350644,0.15730184427455124,0.15637361165085856,0.15551335930173832,0.1547050047447441,0.15385900565860602,0.15330805877645462,0.15202493123892405,0.15322346694923641,0.1539617521568652,0.15369305816277282,0.15284921535208418,0.15128841401512985,0.15044334480639665,0.15004925280915202,0.1493258340534838,0.1462675956585198,0.14493856690938223,0.14382088449836455,0.1415085435015529,0.1403829943967243,0.14031956259692271,0.14043100585392515,0.1397836182239919,0.1386408518869402,0.13812457425616947,0.1380510322587657,0.13537652941593378,0.13608728361816635,0.13467073187226003,0.13365651352911945,0.13339485717390537,0.13239076675919165,0.13251639922595465,0.13146679160434604,0.13199801339288653,0.13333390164090408,0.13252686290059873,0.13254562689617608,0.13182102547423125,0.13143066193183023,0.1302645881588249,0.12947743314372198,0.1293452768661136,0.1292982727402427,0.1274028814375699,0.12707447055382098,0.12723706915580063,0.12768628358239428,0.12652581965675105,0.12762576633000566,0.12705369973550906,0.12804274452542685,0.1272642519097678,0.12445534211826706,0.12181979061192354,0.12118697774825013,0.11920534174935585,0.12007843988162678,0.1194830343838276,0.11877577445523083,0.11754964000635248,0.11678044772348406,0.11648802061632442,0.11678656789966997,0.11597780154399422,0.11617003277457569,0.1164492017038747,0.11594157521165942,0.11528726401758557,0.11484953299700291,0.11344771937366083,0.11366136118347166,0.11376015811045873,0.11336803931708603,0.11192560907304543,0.11134931147918223,0.11127240900795518,0.11114311289180731,0.1111202598840281,0.10995448864053588,0.10851003902646701,0.10924090370567881,0.10901135958564614,0.10932442142264447,0.10943388892323384,0.10906024525195404,0.10878931562470003,0.10895133084603692,0.10959284248825915,0.10951756189708253,0.1093299286940373,0.10907671125535698,0.10903361689563709,0.10994613915091447,0.11060895425390911,0.11088188504288247,0.11001413348510751,0.10736322060607864,0.10722167859319476,0.10761732886887802,0.10693853806389922,0.10729763027345116,0.10669977645765467,0.10669979400838736,0.10545590113935258,0.10536264976689139,0.10478214407147149,0.10470251256135248,0.10423500715723488,0.1041354274580237,0.10399566801264722,0.10314613464097892,0.10254384906147684,0.10172023629070318,0.1013400358898486,0.10074722013305067,0.10080645568088234,0.10084496464782718,0.10041358025309485,0.1002104747313042,0.09979404049132079,0.09847688195897418,0.09839768607750801,0.0980753220340516,0.09748456275721241,0.0972663350338047,0.09628447223391559,0.09664833824250614,0.09668352566868894,0.09579339959482715,0.09590994333649178,0.09446823910382199,0.0940074389158014,0.09529661319237895,0.09586188007557117,0.09592658128058336,0.09631672601438528,0.09612783333807867,0.09531212797599545,0.09628701918413753,0.09620131230795745,0.09479135940938184,0.09463345920031843,0.0946129220273585,0.09311577707724503,0.09186217788505929,0.09253274245700133,0.09145057693871389,0.09095338349624586,0.09114841290415815,0.09104576595404404,0.09115768423725232,0.09109348427556904,0.09165328585640706,0.09136736508982765,0.09042500431654502,0.0902416816627127,0.09037665444151635,0.09038349318731362,0.09030271618107726,0.09061433688118191,0.08936615748477919,0.09000499590777038,0.09070928315620658,0.09070091393890171,0.09139438157633278,0.09131450393567722,0.09171634219248961,0.09064464102345987,0.09058380639667961,0.09090029302551902,0.09072702522778796,0.09111837357084716,0.09161555981275368,0.09078470159896965,0.0904974154099306,0.09055719256791471,0.08952985564161924,0.0886580909314147,0.08857761502858029,0.08806953137936564,0.08833010575600435,0.08767862521396415,0.08746178364359676,0.08792510042673632,0.08779364267833106,0.08777491795420592,0.0875244286305839,0.08757656989955849,0.0874110484481807,0.08706908748815104,0.08766902544123059,0.08805869703202165,0.08826640232466605,0.08820960115258566,0.09016213146133144,0.09003612517641951,0.09025933521423844,0.09022267546886971,0.08988398595279268,0.08962315085918168,0.08995009596207745,0.08961843356951624,0.08974720261475755,0.0894743161281084,0.08824194973944964,0.08795735486602567,0.08876726078881066,0.08906993000369044,0.08869213217510251,0.088657256395455,0.08819088416038427,0.08816674119555014,0.0872781101489573,0.08741503458951146,0.08741717354775899,0.08671770611481928,0.08670180836882249,0.08688076402085257,0.08729247577017482,0.0874048916651577,0.08760217712460143,0.08723016592205629,0.08738921307891495,0.08631350726603838,0.08627997776845284,0.08540608273914149,0.08544199215376096,0.08515848987321006,0.08482861896120739,0.08566025140986097,0.08502483910985695,0.0842582225709957,0.08433087215524845,0.08482367943828727,0.08567401771698312,0.08605241568328974,0.08579922842525847,0.08549321795569652,0.08531027409053991,0.08536659622615678,0.0854339526006472,0.08431320038827259,0.0841185824441541,0.08409135582802972,0.08363597909719785,0.08334043167693975,0.08325876511776696,0.0833408273064887,0.0833287500286484,0.08238898458289305,0.08234094928566059,0.08199319774928727,0.08160357276160836,0.08221769680467969,0.08301432348476176,0.08236931659770139,0.08268606158920273,0.08185758453438287,0.08180468710245414,0.08184173667566376,0.08023856135755542,0.07932842637191542,0.07936537431933507,0.07984804535420822,0.07968451035194436,0.0793995856607085,0.07975373541787846,0.07924470442917127,0.07963728048286697,0.0793735495492177,0.07914486719135759,0.07936610018465193,0.07951914358625164,0.0800452105870054,0.079674848090288,0.08005125502217894,0.08025205704265828,0.0815520225029742,0.08106544916520822,0.0812053656902764,0.08163820409866343,0.08150277991784681,0.0812629562661146,0.08165458750994693,0.0822311973372956,0.08174896290377959,0.08098342729523154,0.08083026163454579,0.07985152501832511,0.07999565349317031,0.07969016910144308,0.08041090510423295,0.0808228865257547,0.07942756125533568,0.07970732229031133,0.08051355321895468,0.08056492053884567,0.08069904849402207,0.08078817969596155,0.08058281575425529,0.08125246292020594,0.0814004760397177,0.08130516706117549,0.08197717216091402,0.08149441991153392,0.08143416002241087,0.08141125985850131,0.08091615446522574,0.08066868312569121,0.08077775778035848,0.08053029820231442,0.08055289388672816,0.08026172636037761,0.08027911723849097,0.07943448884733724,0.07869073882259553,0.07917465109774637,0.07946588286725514,0.07938431116520712,0.08013832699509457,0.08029070155526177,0.0799811004480525,0.08025136844538328,0.07877064730932383,0.0785577735636083,0.07852679204966737,0.07831579747591065,0.07843500381125239,0.07781634620292466,0.07877605430687144,0.0790763595418826,0.07853736839805014,0.07802395752882366,0.07764548138527212,0.07800433259698533,0.07762319909592509,0.07809439779559309,0.07806517700894612,0.07773384741504533,0.0774021000063019,0.07799568108339641,0.07747649141118332,0.07748586112108255,0.07866976033329845,0.07900752006788853,0.07911078446704037,0.07968260895947524,0.0793416355529277,0.07929129745882617,0.0796205189761932,0.07958442051394313,0.0787784808075139,0.07760545940771782,0.07759612265674876,0.07795968030371894,0.07763269240062147,0.0779490587765219,0.07739109377129952,0.07702393979360751,0.07650145479918428,0.07607435018376993,0.07461749836381384,0.07473430010319485,0.07525174592303116,0.0753426400585579,0.0751625136831696,0.0750417290057287,0.07454139223270992,0.07439763359950526,0.07475930397809367,0.07501605832475267,0.0754304737249482,0.07554691068098031,0.07615530216712446,0.07553626085746692,0.07549590785920736,0.0754811649952847,0.0761719316720722,0.07569052320480055,0.0757380078986021,0.07628435812700378,0.0758868956923778,0.07509866770952596,0.07433893321306645,0.07499092714366228,0.0747343506727384,0.07395325682047711,0.0740947940313346,0.0735838504461949,0.07362270590387342,0.07313218065272295,0.07339825731672632,0.07346297568391225,0.07251697403829842,0.07175792994671444,0.07206800218521764,0.07193200327016426,0.07154367786635932,0.07099616106311803,0.07035125486993984,0.07021614801935203,0.07044053498351284,0.07047790522353328,0.07078421092359649,0.0711156629092189,0.07109342430063345,0.07075194711408335,0.07076017076637423,0.07106313635933488,0.0705586831419376,0.07093329361644542,0.07073266738280551,0.07047040166699392,0.07094445203910633,0.07059791550831093,0.07067822242028109,0.07082298183022458,0.07109141471618992,0.0715121236235781,0.07205177231412033,0.07288404238680672,0.07309549277212404,0.07410866221206881,0.07406609116232896,0.07325883087211099,0.07279745061054069,0.07231550850482031,0.0722554791792884,0.0726999374185334,0.07302586953698623,0.07394970150448202,0.07334147625431604,0.07340157121748939,0.0732923087238992,0.07329749986556412,0.07348790355451788,0.07363207803474087,0.07340025384891494,0.07383522048915202,0.07381985274813332,0.07330883202295842,0.07337390638772215,0.0734222982018789,0.07429335156554774,0.075077001111542,0.07602270273110318,0.0757269795965064,0.07625956141388861,0.0763921110845858,0.07679886977424515,0.07719850887095521,0.07675072060977109,0.07627318106119765,0.07619401906008995,0.07483991085972141,0.07567142884240488,0.07523536120497756,0.07522494230052564,0.07509832088794151,0.07402558184348679,0.07439802376928067,0.07430701360664511,0.07373087551534943,0.07417095610864269,0.07459080477908424,0.0742377801603526,0.07504208896672629,0.07556675420932749,0.07568295497324631,0.0763610474778598,0.07712136731555039,0.07833949933919852,0.07887244990449696,0.07986067313349918,0.07983114046119318,0.08006417096737076,0.07973128439000512,0.07985054295080063,0.08017004658270221,0.07997122642984372,0.07920015903286827,0.07882515122019146,0.07830877287349056,0.07828292348986923,0.07807417851430964,0.07773051911176102,0.07779277124938042,0.07829952356585405,0.07856351954562588,0.07848425770302303,0.07855360824425264,0.0782260540906924,0.07794870023162132,0.07808082905329125,0.07725630048514182,0.07788680331250473,0.07790802446791156,0.07768762896737028,0.07721029046540753,0.07702010058571393,0.0768160732346988,0.0771075944188563,0.07656405648052388,0.07685452674755665,0.07762218538073076,0.07781411251240476,0.07786324565703366,0.07740436886976815,0.07711254501729564,0.0770216166500439,0.07706520094023152,0.07721885658934544,0.0773221552460771,0.07772705782279343,0.07852945989048651,0.07877660374340173,0.07898605005198063,0.07966066440151744,0.08009159604484965,0.07976832023055933,0.08013528810365465,0.07997281537352999,0.08049899334957489,0.08045796771516368,0.07926743302756617,0.0793276849465389,0.07892412335328204,0.07921842724919577,0.07974977023310098,0.08002425926824339,0.08003836994001096,0.07980286957946528,0.07983918303187189,0.08026327396151219,0.08090252209245273,0.0821329309255703,0.08204292533344507,0.08264732988503538,0.08311027450469047,0.08307081040505812,0.08394051831452393,0.08422062133839278,0.08401541791946712,0.08484446072699782,0.08491383410452782,0.08493763321992406,0.08383571161265571,0.08353224269422821,0.08365785754247429,0.08281928614369295,0.08288890492177486,0.08290382998284737,0.08252591931452871,0.08285347882119294,0.0814581761514705,0.08128718852889392,0.08096146240754115,0.0813236559600618,0.08179851741131404,0.08109277869299238,0.08155383886766224,0.08171568621583863,0.08144162127496783,0.08156972335418705,0.08131098394714606,0.08054182892521057,0.08053886575414235,0.08101728702336428,0.08058473010249356,0.0808983703318097,0.081657331355384,0.08235288719570158,0.08223421765041308,0.08182586227637723,0.0809644157328224,0.08087268228280432,0.08002666003667516,0.07968675898446748,0.07969618435214233,0.08049635514195758,0.07957388788740447,0.07997231659929104,0.08012266358625156,0.0803133235742456,0.07993230752191297,0.07997106369150106,0.07967534136391029,0.07954754058917525,0.07954578804433304,0.07984373454524853,0.08002769145970534,0.07951658805115046,0.07938547589589069,0.07935887373411657,0.07899101028862146,0.07929723783403439,0.0791001078487856,0.07888833816086659,0.07884737329101668,0.07949017531487665,0.07993698279074313,0.0795021989030724,0.07895957298937194,0.07894450044585426,0.078547975916055,0.07843827180789034,0.07907718646570634,0.07817576346167272,0.07818683276130324,0.07863630395955115,0.07866825303125732,0.07882772030214437,0.07975059650281226,0.07891222767759144,0.07946613102554904,0.07943174815668406,0.07990904811823699,0.07999927585485249,0.07978430897951863,0.0784269929318294,0.07815444037696835,0.0769899397266939,0.07567015732162359,0.0754780269715302,0.07441415119663099,0.0743461428087633,0.07339333075331608,0.07365226424191948,0.0733162651597671,0.07298978768303788,0.0726294447735594,0.07175756218190434,0.07157259519792898,0.07129915851535797,0.071215701953558,0.07180492684453416,0.07200313411343515,0.07282308380921612,0.07276225480091722,0.07275175946257044,0.07324288889274927,0.07338061106857244,0.07306743686833954,0.07256155672188597,0.07308390314229027,0.07254010380463294,0.07237887839254212,0.07080791051590692,0.07091369260842459,0.07121912556838227,0.07162953121950458,0.0718320061519223,0.07153849160714215,0.0715740018874457,0.0716006060360155,0.07143432000902324,0.07086889204482391,0.0708161289003744,0.07054237509427655,0.0708649335332249,0.07061254199106899,0.0703736543190048,0.07080001649462649,0.07082294507244673,0.07091570510974178,0.071065801989699,0.07119203306029961,0.07064007479015748,0.07035049148802634,0.07067208818790152,0.07073570247404831,0.07074389589541066,0.07018043232968205,0.06910533959960125,0.06858290627307438,0.06786174766945058,0.06746921719980746,0.06738452363720485,0.0666336802722973,0.06679885021603167,0.06609729212127152,0.06557909529626584,0.06534401607568655,0.06534378262622367,0.06535859103550959,0.06545965114344508,0.06574117281844935,0.06559956564677298,0.06559929387008409,0.06609853985004663,0.0666159656941728,0.06612255607817585,0.0661225116136604,0.06571807671054834,0.06558491908022772,0.06538506619941217,0.06481136072296141,0.06483801329343505,0.0652245299109706,0.06553840760843979,0.06533161358386305,0.06522158498184631,0.06490063474275307,0.06481758289855641,0.06409003327637562,0.06366576655562348,0.06383439826098318,0.06395274692662367,0.06421528434289134,0.06433636282045722,0.06505485341933885,0.06554906895619649,0.06657123399479517,0.06650773582184205,0.06711556581059239,0.06684726577745942,0.06654739792001246,0.06601528406971814,0.06676507981289945,0.06597474456816632,0.06599121444185642,0.0659244308952722,0.06514108173204056,0.06558646375221622,0.06617409680885424,0.06627315923888835,0.06566167842102108,0.06583208423161306,0.0654555529574511,0.0647315642676163,0.06455691859358845,0.06516155187275165,0.06432838253783364,0.06347602865213216,0.06218784344100699,0.06181952192715402,0.06202177248134374,0.06259519570187957,0.062194701160526035,0.06207046773659587,0.06169683721757827,0.061464513815800356,0.06156604003642455,0.06114962015015686,0.06105915942992659,0.06094643532603407,0.061084018826371586,0.06009470464039614,0.060179760518514626,0.06070874010373382,0.061084111497668125,0.06152252124808908,0.06149111973108147,0.06135946840775397,0.06222044381547263,0.06207483974854037,0.06207205692424207,0.061783805608490464,0.06217122569605151,0.0627453628831429,0.06272989652019005,0.06283850257440278,0.06325741400811435,0.06344096133417454,0.06283329525209043,0.06317545810117785,0.06341002069198923,0.06299225472733228,0.06245387374294653,0.06175472511055543,0.06145213146973601,0.06110112817002448,0.060808651395059685,0.060698511798239776,0.06088381278390957,0.06128801593491172,0.06178829179570068,0.06146140549446285,0.06147302174053025,0.061293892883397406,0.06127474323867762,0.060951924962378834,0.06171895217752473,0.06201565968926356,0.06269453926220461,0.06273328148086602,0.06284949692912746,0.06283699585308547,0.0628161901838094,0.06240337753175769,0.06258980675366048,0.06179513861745996,0.061876130877510704,0.06181438018646285,0.06202502185022261,0.06243280884454124,0.062337994557929946,0.0622943175813351,0.06212079484456419,0.06187010408869226,0.06150587055896496,0.06134527578496871,0.061458567021047704,0.06131806483467069,0.06083681609813283,0.06049881880140817,0.060110946454530356,0.06004465043418106,0.06014281858870722,0.05995819567518906,0.06038901486333751,0.06067438094041836,0.06073489748621798,0.060958738737243466,0.06124164977056795,0.06144518024659348,0.06055704086900624,0.06105085624164645,0.06166565578845136,0.06173180552344324,0.06210551159987114,0.06174159572270975,0.06202075966261161,0.06161238134438749,0.06174148284988327,0.06150938097034362,0.06101651795961836,0.06075675179950311,0.06129195205973368,0.061002846628021766,0.06103363075415415,0.0616212546645174,0.06208635760542107,0.061848094636483816,0.06162163488336588,0.06175830983433591,0.06180419670623236,0.06215329885243807,0.06224610348201152,0.06260665930127016,0.06256160063882862,0.061872530110071565,0.06212799553880995,0.06318891310689953,0.06288612510506106,0.0632402996751347,0.061971908574761723,0.06192452373743853,0.0617430185829186,0.0625221583713364,0.06268682412913193,0.06350033965690935,0.06372141667444184,0.06393690197786754,0.06369254187696141,0.06445172688468814,0.06476251507801957,0.06441623612212295,0.06463974883944852,0.06458953010103344,0.06406359183709914,0.06427040638948232,0.06450607314424303,0.06411081743262352,0.06328325621598066,0.0632229491161638,0.06236629277024612,0.06225132966369863,0.06194855801848374,0.060590520534123185,0.06098200804517212,0.06084068116057467,0.06048629095761732,0.060226101485087793,0.060074082675546835,0.06029116005549785,0.06048557103198583,0.06013738506483762,0.06019256533683167,0.06044855136286058,0.06052813571139,0.06087747465704999,0.06117433916471854,0.06149860784217298,0.061587233333437776,0.061869910976940536,0.06212269019827922,0.06198080852228308,0.06194329278136331,0.0612940994525046,0.061243452624608896,0.060704562105010226,0.0612521431616332,0.060981267579038656,0.06123958021968643,0.06120385473280586,0.06142301846231939,0.06101475341183521,0.06061801107464918,0.060786900827380176,0.06095369803089036,0.061124405950479924,0.06121396527561164,0.0612234599107506,0.06158787290556698,0.061685521812863554,0.0608609552363089,0.060793646602768,0.061427856642623145,0.06138719098830714,0.06107814013924029,0.06071935401723433,0.06100054622363359,0.06134622913287631,0.06148050935070094,0.06132907371658628,0.0613389412096589,0.061364198517758595,0.06106928565815796,0.06115327323124432,0.06108836363736987,0.06144273351813523,0.06067708540991412,0.06034151001660012,0.060259929807473724,0.06014384530225868,0.05993002549837623,0.05996836046999685,0.06010245283801822,0.06013359800608331,0.06004896493529721,0.05980959885332188,0.0598560565668667,0.0595484078134715,0.05944650332485629,0.05880154407833218,0.05845363315843509,0.05853170195996259,0.05851904866121199,0.05843719705826815,0.058529410357680355,0.057657827529923086,0.05772901589209763,0.05874137768723973,0.05868168338511083,0.05821135986428812,0.05650758485584774,0.05645484997734033,0.05656744377337637,0.05656549370697543,0.05627663031010175,0.05617600013652511,0.05659313035055148,0.05635387851522985,0.05636875896228052,0.057144192968283436,0.057171148976831565,0.05745661138091205,0.056995898661406974,0.05681530533536141,0.056543480909515234,0.05633641683703124,0.056230989278955965,0.05616387763401143,0.056000347962920236,0.05630010313097703,0.0566273519635788,0.05686557290854758,0.0570005666510063,0.05659258518496888,0.056488966672245754,0.056661144007513584,0.05685443601573002,0.05696271260160944,0.05651790056908459,0.056412506962720474,0.05653305097628999,0.05660565779410838,0.056915702471534615,0.05690791335705507,0.057550610687919945,0.05799956579854891,0.05683725339324323,0.056862057393734844,0.056522253123519994,0.05707173619219663,0.05713535051368901,0.05651875100171501,0.057118425096116254,0.05607990320702557,0.05616650410733014,0.05627318614094776,0.0567003723291941,0.05595151243618903,0.056236895542699485,0.055742330509273554,0.055565236226213635,0.0548612261293691,0.05411552335576505,0.05449542990895919,0.05478255579087525,0.054312277809987985,0.0541679157237913,0.0542851317547582,0.05436729375182978,0.05421080803583299,0.05365233793867635,0.053295777601821026,0.05273420840614149,0.052986677149904814,0.05265692062073738,0.05258519004011665,0.0525746774962723,0.052987160682265014,0.05288590366196696,0.05288470758872721,0.05294649316958507,0.05252670007079,0.052248901459659255,0.05193456867934456,0.05142191093129448,0.051580584852272106,0.05178947166898864,0.052003083080961646,0.05222977941167094,0.05206081470706727,0.05219236888019206,0.05243414243597121,0.05194758276175898,0.05212650586539626,0.05259526853676318,0.05249183687129048,0.05272465161410128,0.053047778769293286,0.05383268078728278,0.05407016006661568,0.0542193870909284,0.054436497225930566,0.0543422422346768,0.054256362007969426,0.05421830152303061,0.05403678801733269,0.054114006478939256,0.054320896888972445,0.05445395281628033,0.05376833422227882,0.05326722465350593,0.05291916848855156,0.05335000722865986,0.053310810427908584,0.053388226720608625,0.05343946774991052,0.053286591523183144,0.0532916183224363,0.0533716056346793,0.053120657599562505,0.052849625681887426,0.05265869833061495,0.052691935743293394,0.052597511507148066,0.05239948613498704,0.05197039795700829,0.051905142388563655,0.051551920097695755,0.05199204605409913,0.05200327773328889,0.05210245965920126,0.05205023679078609,0.05138195486975865,0.051253386544285726,0.05121297314801761,0.05150743988490408,0.051220660798485085,0.05178830386575327,0.05175144836572467,0.05179743653339166,0.05215181797459386,0.05222344332011829,0.051870539694425066,0.05183768809376654,0.05221368217269701,0.05257216981937378,0.052388271439781385,0.051522413784962286,0.051591005290555526,0.05160315955351456,0.05152751715093186,0.05181889859085448,0.05184696291284385,0.0516786120903175,0.051033851903667785,0.05112367964773652,0.050729452039902756,0.050719008448380176,0.05093661044593314,0.05124556195175396,0.051359099391314944,0.05133569545494571,0.0511075049906464,0.05101889262076672,0.05093416377992149,0.05049450025604556,0.050481706404430116,0.050819307429539586,0.050460751144813354,0.05059906541957633,0.05058882850913534,0.05030336129116675,0.05019624570363661,0.05036640320919735,0.05050670901247919,0.05040836029632763,0.04993630979506753,0.050129675530427555,0.05007675638809448,0.05018647871459838,0.050301193522155084,0.050474567205340284,0.05028688128215432,0.050009504565509434,0.04958886437878002,0.04963180356243095,0.05001051617676573,0.05016860477983526,0.04973175467821108,0.04979409148731119,0.04990867162682388,0.05032260373461154,0.05047964802335895,0.050107471821295865,0.050649562800019664,0.05023706112833169,0.05057993791016631,0.050436322679518183,0.05080167399302393,0.05091558651194916,0.05110147918620345,0.05120173695120202,0.05112631943392633,0.051350448207731214,0.0507701529502058,0.051313099064439746,0.05095677582970611,0.051346073136415905,0.05130581225333254,0.050546686579729584,0.0506918993030428,0.05098125198635441,0.05078097692530707,0.05075016508480322,0.05040553943002805,0.05046077110162147,0.05071173499875562,0.05063364751615225,0.05075304892171708,0.05063103905753621,0.050338449254521876,0.05047582184221994,0.05060043618434077,0.050943311938834016,0.05087038470564763,0.05077644148752859,0.051349046365178896,0.05131289753181434,0.05160098205195192,0.05200457933468401,0.0518338831991613,0.05187093178688321,0.05111058832114276,0.05170507768972291,0.05126540135949241,0.05070686397767227,0.0499398157185821,0.050028405736589954,0.050052326045063586,0.05041176917691194,0.050770915048905116,0.050662192227513725,0.050306776980046784,0.0499970254203438,0.04972884475399691,0.04944237506887586,0.04937094207274975,0.048930313526146726,0.04928369229252068,0.04921515732233393,0.04860547646204579,0.04850380732517768,0.048513788567007894,0.04851747187506728,0.04828916539011828,0.04807993156347504,0.04759323821842432,0.047817200656548785,0.047743684912810516,0.047772247915590434,0.04743375941851939,0.04686436215671934,0.046606509086966424,0.046835200426999436,0.04716915770469769,0.04709708422504134,0.04720328424657008,0.04720549701524214,0.0465341131034695,0.046575256911524386,0.046699961025170114,0.0460939496456693,0.04632832020304518,0.046598470155075344,0.04643353010985775,0.04577550880510638,0.045811979207273375,0.04566348093832838,0.045673988674812656,0.04602197682945611,0.045923131273357086,0.04604774821998582,0.04632594827414001,0.046243694550534106,0.046616772694211536,0.04693421170109012,0.0475893220057102,0.04748939149171429,0.04773584608613533,0.0474521805705153,0.04790912713716376,0.04790662977074785,0.04805213404504823,0.04692070513251184,0.04723902362903987,0.04694134989657488,0.04710176178989433,0.046524387586162494,0.046673889210029615,0.04642992867228439,0.046287354477398915,0.04618040682250573,0.046155968936427025,0.046366838693961396,0.04626157662137011,0.04630623972354653,0.046145981506911,0.04609725220600493,0.04632155531203017,0.046364338278609904,0.04638616569226398,0.0460576945100631,0.04569410294952605,0.044996560435181215,0.04431704564947854,0.04434367821072591,0.04461263371187741,0.0447352058956682,0.04491301546091878,0.04448140468621274,0.0444310917726529,0.04444470503602761,0.04404256607794497,0.04461061136402777,0.04504546465479808,0.045005913795176135,0.04548711136882385,0.045489343038374305,0.04501738476728974,0.04451872404209225,0.04454258625406525,0.044399557233616924,0.044421783607960466,0.04423483729377636,0.04405539209114198,0.04375109639791337,0.04310065738300465,0.04296171249327218,0.0430563594619512,0.043207630556005405,0.04339294185850316,0.04322151360180261,0.04336526388186697,0.043349540114277094,0.04324705217723229,0.04358318657133038,0.04363030403408557,0.04380978401433721,0.04420581579655148,0.04381199372105288,0.043752799639732345,0.043579362120058134,0.0442110582637391,0.04460797363183545,0.04435585709063624,0.043791870608939645,0.04388954866137864,0.044472883592769435,0.044567670832396676,0.04456471314729266,0.0443763545778547,0.044229662409175474,0.04442536990676073,0.045001054944167944,0.04496082551920409,0.04508912554115464,0.044823266785144825,0.04466507086474934,0.04423100966983808,0.044760664621693716,0.04479012521419967,0.04490030919881533,0.044677011980725,0.04484287746348637,0.04459379346407749,0.04429052474233992,0.04454694288640108,0.044670044828153926,0.04424539944050722,0.04423615637193011,0.044276949019365935,0.043872661336838696,0.04409842206549611,0.044055951440764074,0.04435301889907088,0.0442256205864678,0.044518752358892785,0.04503332022873396,0.04546840564928425,0.04549443204280435,0.045892873399431905,0.04550620424508266,0.045590905672060755,0.04555004788646153,0.04544361886988053,0.04539237632883553,0.045498456747380865,0.04538811976298285,0.04513312484694976,0.044775078127897376,0.045011682020135765,0.04508296077587615,0.04546858377305885,0.045494429085120316,0.04538047080879663,0.04500187957320542,0.044938002056510405,0.04468264118357056,0.04489720078917843,0.0449147133768578,0.04488044894166444,0.04445142949327194,0.044394508033390144,0.04453304306795817,0.044586567944953734,0.04488547273468031,0.04535075300491165,0.045814502614810675,0.04600609540851495,0.04543325025572471,0.0454353180922404,0.045787258890845964,0.04545543140860253,0.044752806991518214,0.045023391958464484,0.04510171097741559,0.04541043245892283,0.04541915860607077,0.04496793083648529,0.044243792375458814,0.044239237843291514,0.04393076998011717,0.043970313344153196,0.04352563600947296,0.04352400047627048,0.0433915628520539,0.04342302971637501,0.04375357396443542,0.04352467482255111,0.04318089280483821,0.043303133693974136,0.04334004794898651,0.04366156960623119,0.0438039446348854,0.0435052071870882,0.04394606558722967,0.043926791189631595,0.04356526451592462,0.04347212243283122,0.04369845140854679,0.0436980573483007,0.043896643732565105,0.044026761982563986,0.0439412451036807,0.043610157878425655,0.043603318071142066,0.04357368380846775,0.04402986870897239,0.04412921984616139,0.043952682572333514,0.044046536216471754,0.0442503088757772,0.044179465318925436,0.044404915063314856,0.04591705318624771,0.04571852079126509,0.0459392301451213,0.0461691083455135,0.04584691485677053,0.045544182765564635,0.04567795933512876,0.04589412720726659,0.045573460707611375,0.04585998684715876,0.045969285983921235,0.046444487064291703,0.046143755567006034,0.04630920494799618,0.045993789469188716,0.04588825092102018,0.04710446142704523,0.04726235079264452,0.04754505296708981,0.04687837168642354,0.04740176521224135,0.04668309211680289,0.046799668178751884,0.047893682146359036,0.04813374086514478,0.04859325819060961,0.04884813151421878,0.049050531931721916,0.04905632878877499,0.04905339672819849,0.04884734027568809,0.048865448511385357,0.04872323848300779,0.0488926800504843,0.04897412601548399,0.04885036208264819,0.04878029156234813,0.048601418704920525,0.04822414537753773,0.04829488201300057,0.04810526161085946,0.048089699351304124,0.047843816037916057,0.047853887994234776,0.04802941433161838,0.04791961772096438,0.04771042725003492,0.047452423490396745,0.047623504321411894,0.047956024341357505,0.048211363932830285,0.048454789360266946,0.048666836151420666,0.049193910614133245,0.049245453573160944,0.049346958028656636,0.049066149378774626,0.04870050059861546,0.04900564098184475,0.048835143757934206
  )

  pl.addline(data, "")


  pl.p.legend = false

  pl.print("jumps.pdf")
}
